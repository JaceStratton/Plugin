package me.jacestratton;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Random;
import java.util.Scanner;

/**
 * Array of tips that can be added to and searched through.
 * 
 * @author JaceStratton
 * 
 * @version 1.0
 */
public class GuideBook {
    private Scanner scanner;
    private File file;
    private String[] tips;
    private int numberOfTips;
    private Random random;

    /**
     * Default constructor that constructs an array of tips.
     * 
     * @throws FileNotFoundException
     */
    public GuideBook() throws FileNotFoundException {
        file = new File("C:/Users/Drew/Desktop/Server/plugins/tips.txt");
        scanner = new Scanner(file);
        tips = new String[10000];
        numberOfTips = 0;
        random = new Random();
        int i = 0;
        while (scanner.hasNextLine()) {
            tips[i] = scanner.nextLine();
            numberOfTips++;
            i++;
        }
        scanner.close();
    }

    /**
     * Prints a random tip to send to chat.
     * 
     * @return A random tip.
     */
    public String printTip() {
        int randomInt = random.nextInt(numberOfTips) + 1;
        return randomInt + "/" + numberOfTips + " - " + tips[randomInt - 1];
    }

    /**
     * Searches through the array of tips by number.
     * 
     * @param number
     *            The number of the tip.
     * @return The tip specified by the number.
     * @throws FileNotFoundException
     */
    public String searchTip(int number) {
        if (number > 0 && number <= numberOfTips) {
            return number + "/" + numberOfTips + " - " + tips[number - 1];
        }
        return "You must specify a number between 1 and " + numberOfTips + ".";
    }

    /**
     * Searches through the array of tips with a keyword.
     * 
     * @param keyword
     *            The string to search tips for.
     * @return The tip to return.
     * @throws FileNotFoundException
     */
    public String searchTip(String keyword) throws FileNotFoundException {
        Scanner scanner = new Scanner(file);
        String[] tips = new String[numberOfTips];
        int i = 0;
        while (scanner.hasNextLine()) {
            String tip = scanner.next();
            if (tip.contains(keyword)) {
                tips[i] = tip;
                i++;
            }
        }
        scanner.close();
        if (i == 0) {
            return "No match found";
        }
        return tips[random.nextInt(i)];
    }

    /**
     * Returns the number of tips in the array.
     * 
     * @return The number of tips as a string.
     */
    public String numberOfTips() {
        return Integer.toString(numberOfTips);
    }

    /**
     * Adds a tip to the tip array.
     * 
     * @param tip
     *            The tip to add.
     * @throws IOException
     */
    public void addTip(String tip) throws IOException {
        FileWriter fileWriter = new FileWriter("C:/Users/Drew/Desktop/Server/plugins/tips.txt");
        PrintWriter printWriter = new PrintWriter(fileWriter);
        for (int i = 0; i < numberOfTips; i++) {
            printWriter.println(tips[i]);
        }
        printWriter.println(tip);
        printWriter.close();
        fileWriter.close();

    }

}
